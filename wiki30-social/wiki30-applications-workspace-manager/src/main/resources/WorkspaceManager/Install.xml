<?xml version="1.0" encoding="UTF-8"?>
<xwikidoc>
<web>WorkspaceManager</web>
<name>Install</name>
<language></language>
<defaultLanguage>en</defaultLanguage>
<translation>0</translation>
<parent>WorkspaceManager.WebHome</parent>
<creator>XWiki.Admin</creator>
<author>XWiki.Admin</author>
<customClass></customClass>
<contentAuthor>XWiki.Admin</contentAuthor>
<creationDate>1187017247000</creationDate>
<date>1308845948000</date>
<contentUpdateDate>1308845948000</contentUpdateDate>
<version>1.1</version>
<title></title>
<template></template>
<defaultTemplate></defaultTemplate>
<validationScript></validationScript>
<comment></comment>
<minorEdit>false</minorEdit>
<syntaxId>xwiki/2.0</syntaxId>
<hidden>false</hidden>
<content>{{velocity}}
#if (!$WikiManager)
  #set($WikiManager = $xwiki.wikimanager)
  #if(!$WikiManager)
    {{error}}$msg.get('wikimanager.pluginnotenabled'){{/error}}
  #end
#end
#if(!$xwiki.applicationmanager)
  {{error}}$msg.get('xapp.pluginnotenabled'){{/error}}
#end
##
## Constants
#set ($TEMPLATE_NAME = 'workspacetemplate')
#set ($TEMPLATE_PACKAGE = 'workspace-template.xar')
##
#set($Exception = $WikiManager.DefaultException)
#set($template = $WikiManager.getWikiTemplateDocument($TEMPLATE_NAME))
#if("$!template" == '')
  #if ($doc.getAttachment($TEMPLATE_PACKAGE))
    #set($result = $WikiManager.createWikiTemplate($TEMPLATE_NAME, 'Workspace Template', $TEMPLATE_PACKAGE))
    #if ($result == $Exception.ERROR_NOERROR)
      {{info}}$msg.get('workspacemanager.template.install.success'){{/info}}
    #elseif ($result == $Exception.ERROR_XWIKI_ACCESS_DENIED)
      {{error}}$msg.get('workspacemanager.template.install.notallowed'){{/error}}
    #else
      {{error}}$msg.get('workspacemanager.template.install.error', [$context.lastexception]){{/error}}
    #end
  #else
    {{error}}$msg.get('workspacemanager.template.install.error.missingattachment', [$TEMPLATE_PACKAGE, $doc.fullName]){{/error}}
  #end
#else
  ##
  ##Don't display this information if the code is included from somewhere else.
  ##
  #if($context.doc == $context.tdoc)
    {{info}}$msg.get('workspacemanager.template.install.success'){{/info}}
  #end
#end
{{/velocity}}</content></xwikidoc>
